<div class="assignment-card" [ngStyle]="{'border-color': getGroupColor()}">
    <div class="group-header">
        <h3>{{assignment.curso.codigo}} - {{assignment.curso.descripcion}}</h3>
        <span class="students-count">{{assignment.total_estudiantes}} estudiantes</span>
    </div>

    <div class="group-info">
        <p><strong>Grupo:</strong> {{assignment.grupo.id_grupo}}</p>
        <p><strong>Facultad:</strong> {{assignment.grupo.facultad}}</p>
        <p><strong>Generación:</strong> {{assignment.grupo.generacion}}</p>
    </div>

    <div class="horarios-section" *ngIf="(assignment.horarios?.length ?? 0) > 0">
        <h4>Horarios:</h4>
        <div class="horario-item" *ngFor="let horario of assignment.horarios">
            <span>{{horario.dia_semana | titlecase}}: {{horario.hora_inicio}} - {{horario.hora_fin}}</span>
        </div>
    </div>

    <div class="planeacion-section">
        <!-- Cuando ya tiene planeación -->
        <div *ngIf="assignment.tiene_planeacion" class="planeacion-available">
            <button (click)="openPlaneacion(assignment.planeacion_pdf_url)" class="pdf-link planeacion-button">
                Ver Planeación
            </button>
            <button (click)="showUploadForm = true" class="upload-button">
                Actualizar PDF
            </button>
        </div>
    
        <!-- Cuando no tiene planeación -->
        <div *ngIf="!assignment.tiene_planeacion" class="no-planeacion">
            <p>Sin planeación disponible</p>
            <button (click)="showUploadForm = true" class="upload-button">
                Subir Planeación
            </button>
        </div>
    
        <!-- Formulario para subir archivo -->
        <div *ngIf="showUploadForm" class="upload-form">
            <input type="file" accept=".pdf" (change)="onFileSelected($event)" #fileInput class="file-input">
    
            <div class="upload-actions">
                <button (click)="uploadPdf()" [disabled]="!selectedFile || isUploading" class="submit-button">
                    {{ isUploading ? 'Subiendo...' : 'Subir PDF' }}
                </button>
                <button (click)="cancelUpload()" class="cancel-button">
                    Cancelar
                </button>
            </div>
    
            <!-- Mostrar nombre del archivo seleccionado -->
            <div *ngIf="selectedFile" class="selected-file">
                Archivo seleccionado: {{ selectedFile.name }}
            </div>
        </div>
    </div>

    <div class="students-section">
        <button class="students-button" (click)="toggleStudentList()">
            {{ showStudents ? 'Ocultar Lista de Estudiantes' : 'Lista de Estudiantes' }}
        </button>
        <div class="loading-students" *ngIf="loadingStudents">
            Cargando estudiantes...
        </div>
        <div class="error-message" *ngIf="errorMessage && !loadingStudents">
            {{ errorMessage }}
        </div>
        <div class="students-list" *ngIf="showStudents && students.length > 0 && !loadingStudents">
            <h4>Estudiantes:</h4>
            <div class="student-item" *ngFor="let student of students">
                <span>{{ student.nombre }} {{ student.apellido_paterno }} {{ student.apellido_materno }} ({{
                    student.id_alumno }})</span>
            </div>
        </div>
        <div class="no-students" *ngIf="showStudents && students.length === 0 && !loadingStudents && !errorMessage">
            No hay estudiantes registrados.
        </div>
    </div>
</div>